from sqlalchemy.sql.schema import Column
from sqlalchemy.sql.sqltypes import BigInteger, Float, String
from datamodel.mixins import PublicIdMixin, ClassificationMixin
from datamodel.base import ORMBase


class VulnerabilityModel(PublicIdMixin, ORMBase):
    """Vulnerability model"""
    m_assetcategory = Column(String)
    m_description = Column(String)
    m_losscategory = Column(String)


class VulnerabilityFunction(ClassificationMixin('m_taxonomy'), ORMBase):
    """Vulnerability functiton model"""
    _parent_oid = Column(BigInteger)
    m_distribution = Column(String)
    m_intensitymeasuretype = Column(String)


class IntensitySpecificVulnerability(ORMBase):
    """Intensity specific vulnerability model"""
    _parent_oid = Column(BigInteger)
    m_covariancelossratio = Column(Float)
    m_intensitymeasurelevel = Column(Float)
    m_meanlossratio = Column(Float)
