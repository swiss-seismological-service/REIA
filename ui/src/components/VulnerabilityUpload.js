import React from 'react';
import 'whatwg-fetch';
import { Button, Grid, Paper, Typography } from '@material-ui/core';

import { postVulnerability } from '../util/api';
import FileUpload from '../util/fileUpload';

class VulnerabilityUpload extends React.Component {
    state = {
        selectedVulnerabilityModel: null,
    };

    handleSubmission = () => {
        this.props.reload(null, true);
        postVulnerability({ ...this.state }).then((response) => {
            this.props.reload(response, false);
        });
    };

    setVulnerabilityModel = (file) => {
        this.setState({ selectedVulnerabilityModel: file[0] });
    };

    render() {
        return (
            <Paper className="paper">
                <Typography gutterBottom variant="h5" component="h2">
                    Vulnerability Model
                </Typography>
                <Grid container spacing={3} className="grid">
                    <Grid item xs={2}>
                        <FileUpload
                            currentFile={this.state.selectedVulnerabilityModel}
                            setFile={this.setVulnerabilityModel}
                            name="vulnerabilityModel"
                        >
                            Vulnerability
                        </FileUpload>
                    </Grid>
                    <Grid item xs={2}>
                        <Button variant="contained" color="secondary" onClick={this.handleSubmission}>
                            Submit
                        </Button>
                    </Grid>
                </Grid>
            </Paper>
        );
    }
}

export default VulnerabilityUpload;
