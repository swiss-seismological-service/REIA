import React, { useState } from 'react';
import { Button, Grid, Paper, Typography } from '@material-ui/core';

import { postVulnerability } from '../util/api';
import FileUpload from '../util/fileUpload';

export default function VulnerabilityUpload(props) {
    const [vulnerabilityModel, setVulnerabilityModel] = useState(null);

    const handleSubmission = () => {
        props.reload({ vulnerabilityModels: null, vulnerabilityLoading: true });
        postVulnerability(vulnerabilityModel).then((response) => {
            props.reload({ vulnerabilityModels: response, vulnerabilityLoading: false });
        });
    };

    const handleFiles = (e) => setVulnerabilityModel(e.target.files);

    return (
        <Paper className="paper">
            <Typography gutterBottom variant="h5" component="h2">
                Vulnerability Model
            </Typography>
            <Grid container spacing={3} className="grid">
                <Grid item xs={2}>
                    <FileUpload currentFile={vulnerabilityModel} setFile={handleFiles} name="vulnerabilityModel">
                        Vulnerability
                    </FileUpload>
                </Grid>
                <Grid item xs={2}>
                    <Button variant="contained" color="secondary" onClick={handleSubmission}>
                        Submit
                    </Button>
                </Grid>
            </Grid>
        </Paper>
    );
}
